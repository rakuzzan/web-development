const popupBg=document.querySelector(".popup-bg"),popupContent=document.querySelector(".popup__content"),openPopupBtn=document.querySelectorAll(".button"),closePopup=document.querySelector(".btn_close-popup"),sendPopupBtn=document.querySelector(".form__button"),popup=document.querySelector(".popup");openPopupBtn.forEach(a=>{a.addEventListener("click",()=>{popupBg.classList.add("active"),popupContent.classList.add("active")})}),closePopup.addEventListener("click",()=>{popupBg.classList.remove("active"),popupContent.classList.remove("active")}),document.addEventListener("click",a=>{a.target===popupBg&&(popupBg.classList.remove("active"),popupContent.classList.remove("active"))}),document.addEventListener("keydown",a=>{"Escape"===a.key&&(popupBg.classList.remove("active"),popupContent.classList.remove("active"))});const email=document.getElementById("email"),name=document.getElementById("name"),profession=document.getElementById("profession"),agreement=document.getElementById("agreement");function validate(a,b){let c=/^[\w-\.]+@[\w-]+\.[a-z]{2,4}$/i.test(a.value),d=/^[a-zа-яё]+$/i.test(b.value);return c?a.style.borderColor="#C0C0C0":a.style.borderColor="#EE5858",d?b.style.borderColor="#C0C0C0":b.style.borderColor="#EE5858",c&&d}popupContent.addEventListener("click",()=>{""!==email.value&&""!==name.value&&validate(email,name)}),sendPopupBtn.addEventListener("click",()=>{if(""===email.value&&(email.style.borderColor="#EE5858"),""===name.value&&(name.style.borderColor="#EE5858"),validate(email,name)){let b={name:name.value,email:email.value,profession:profession.value,agreement:agreement.checked};async function a(){let c=await fetch("form_handler.php",{method:"POST",headers:{"Content-type":"application/json; charset=utf-8"},body:JSON.stringify(b)}),d=await c.json();if(console.log(d),c.ok&&200===d.status)popupBg.classList.remove("active"),popup.classList.remove("active"),name.value="",email.value="",profession.value="",agreement.checked=0;else{popupContent.classList.add("disable");let a=document.createElement("h2");a.innerHTML="\u0423\u043F\u0441.. \u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430!",a.classList.add("popup__error-message"),popup.appendChild(a)}}a()}})